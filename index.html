<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puck Guide</title>
    <meta name="description" content="A simple guide to setting up Puck servers">
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="icon" href="./assets/images/favicon.jpg">
    <link rel="apple-touch-icon" href="./assets/images/favicon.jpg">
</head>
<body>
    <header>
        <nav>
            <a href="https://github.com/CodionCA/PuckGuide">
                <svg class="icon" viewBox="0 0 32 32">
                    <path d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z"></path>
                </svg>
                Github
            </a>
        </nav>
        
        <h1>Puck Guide</h1>
        <p>A quick guide to hosting your own Puck server</p>

        <div class="navigation-buttons">
            <a href="#simpleGuide">
                <button>Simple</button>
            </a>
            <a href="#advancedGuide">
                <button>Advanced</button>
            </a>
        </div>
    </header>

    <main>
        <section id="simpleGuide">
            <h2>Getting Started - The Simple Way</h2>
            
            <p>There are TWO different ways of hosting your own Puck server, one is to simply open your game up normally and open the "SERVER BROWSER" menu and select "NEW SERVER" at the bottom</p>

            <div class="image-container">
                <img src="assets/images/serverbrowsermenu.png" alt="Server Browser">
            </div>
            <p>You will be presented with this screen</p>
            <div class="image-container">
                <img src="assets/images/newservermenu.png" alt="New Server Menu">
            </div>
            
            <div class="server-options">
                <ul>
                    <li>
                        <strong>Server Type:</strong> Choose between "Self Hosted" or "Dedicated"
                        <ul>
                            <li><em>Self Hosted means on your own system and network, Dedicated uses Pucks own servers however are limited in Tick rate and can feel quite <a href="#tickrate">sluggish</a></em></li>
                        </ul>
                    </li>
                    
                    <li>
                        <strong>Name:</strong> Enter your server name (appears in server browser)
                        <ul>
                            <li><em>You can use <a href="https://docs.unity3d.com/Packages/com.unity.ugui@1.0/manual/StyledText.html">Unity Rich Text</a> for colours and sizes, be careful of the character limit & do not abuse this</em></li>
                        </ul>
                    </li>
                    
                    <li>
                        <strong>Port:</strong> Set the port number (default is 7777)
                        <ul>
                            <li>This is the port you will either <a href="#portforwardGuide">forward</a> (in your modem/router panel) or you can enable <a href="#upnpGuide">UPNP</a></li>
                        </ul>
                    </li>
                    
                    <li>
                        <strong>Maximum Players:</strong> Use slider to set player limit
                    </li>
                    
                    <li>
                        <strong>Password Protected:</strong> Toggle to require password for joining
                    </li>
                    
                    <li>
                        <strong>Password:</strong> Enter password if protection is enabled
                    </li>
                    
                    <li>
                        <strong>VoIP:</strong> Toggle voice chat on/off (checkbox)
                    </li>
                </ul>
            </div>

            <div class="help-button">
                <a href="#portforwardGuide">
                    <button>Not working?</button>
                </a>
            </div>

            <hr>

            <div class="notice" id="tickrate">
                <h4>⚠️ Important Considerations</h4>
                <p><em>This method relies on good ping and framerate. Dedicated servers are limited to 100hz/100fps. Self-hosted servers need solid network and system specs for higher refresh rates.</em></p>
                <p>The videos below show high vs low frame rates. In Puck, physics run server-side, so your mouse movements are limited by the server's tick rate, causing sluggish controls unless adjusted.</p>
                <div class="video-container">
                    <video autoplay loop muted playsinline>
                        <source src="assets/images/24fpsexample.mp4" type="video/mp4">
                    </video>
                    <video autoplay loop muted playsinline>
                        <source src="assets/images/280fpsexample.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </section>

        <section id="portforwardGuide" class="globalguide">
            <h2>Port Forwarding Setup</h2>
            
            <p>If players can't connect to your server, you need to open ports <strong>7777</strong> and <strong>7778</strong> (UDP) on your router.</p>
            
            <p><strong>Access your router's admin panel:</strong> Run <code>ipconfig</code> in Windows Terminal, copy the "Default Gateway" IP address (like 192.168.1.1), paste it into your browser's address bar, then log in using the credentials typically on your router's label.</p>

            <p><strong>Port Forward Setup Example:</strong></p>
            <ul>
                <li>Protocol: <code>UDP</code></li>
                <li>External Port: <code>7777</code> and <code>7778</code></li>
                <li>Internal Port: <code>7777</code> and <code>7778</code></li>
                <li>Internal IP: Your PC's local IP (find with <code>ipconfig</code> in Windows terminal)</li>
            </ul>
            
            <h3>Port Forwarding Guides by Router Brand</h3>
            <ul>
                <li><a href="https://support.linksys.com/kb/article/318-en/" target="_blank">Linksys Router Port Forwarding Guide</a></li>
                <li><a href="https://kb.netgear.com/000053857/Enable-Port-Forwarding" target="_blank">Netgear Router Port Forwarding Guide</a></li>
                <li><a href="https://www.asus.com/support/faq/1037906/" target="_blank">ASUS Router Port Forwarding Guide</a></li>
                <li><a href="https://www.tp-link.com/us/support/faq/1379/" target="_blank">TP-Link Router Port Forwarding Guide</a></li>
                <li><a href="https://portforward.com/" target="_blank">Universal Port Forwarding Guide (All Brands)</a></li>
            </ul>
            
            <h3 id="upnpGuide">Enabling UPnP</h3>
            <p><strong>Alternative:</strong> You can enable UPnP instead of manual port forwarding. This is less reliable but automatically handles port forwarding for all applications. Look for a UPnP toggle in your router admin settings (usually at <code>192.168.1.1</code>).</p>
            
            <div class="notice">
                <h5>Security Warning</h5>
                <p>Enabling UPnP can resolve connection issues rather than simply port forwarding, however, this can create security vulnerabilities. A lot of routers have UPnP disabled by default for a reason.</p>
                <div class="readmoresec">
                    <a href="https://nordvpn.com/blog/what-is-upnp/">
                        <button>Read More</button>
                    </a>
                </div>
            </div>
            
            <h3>Still Can't Connect?</h3>
            <p>Check that your PC's firewall is also allowing ports 7777 and 7778 through. Windows Firewall and other security software can block these ports even when your router is configured correctly.</p>
        </section>

        <section id="advancedGuide">
            <h2>The Advanced Way</h2>

            <p>Want something a little more permanent, with higher tick rates and more performant?</p>
            
            <blockquote>
                <strong>What You'll Need</strong><br>
                <em>This guide covers setting up a dedicated server using Steam/SteamCMD. You'll need basic command line knowledge and either a VPS or spare hardware.</em>
            </blockquote>
            
            <h3>VPS vs Home Server</h3>
            
            <h4>VPS (Virtual Private Server)</h4>
            <ul>
                <li><strong>Pros:</strong> Professional hosting, better uptime, no home network impact</li>
                <li><strong>Cons:</strong> Monthly cost, requires remote management</li>
                <li><strong>Recommended for:</strong> 24/7 servers, multiple players, public servers (such as CDL & PHL)</li>
            </ul>
            
            <h4>Home Server/Hardware</h4>
            <ul>
                <li><strong>Pros:</strong> No ongoing costs, full control, can use spare hardware</li>
                <li><strong>Cons:</strong> Uses your internet bandwidth, electricity costs, setup complexity</li>
                <li><strong>Recommended for:</strong> Friends & family servers, testing, learning, or single location servers</li>
            </ul>
            
            <h3>Choosing an Operating System</h3>
            
            <p><strong>Debian</strong> - <strong>Recommended and covered in the guide below</strong><br>
            Rock solid stability, perfect for beginners. Most stable option, great documentation, minimal resource usage.</p>
            
            <p><strong>Ubuntu Server</strong><br>
            User-friendly with great community support. Easier for newcomers, lots of tutorials available online.</p>
            
            <p><strong>Fedora Server</strong><br>
            Modern features and cutting-edge packages. Good choice if you want newer software versions.</p>

            <p><strong>Docker Container</strong><br>
            Easiest to deploy, requires a docker image (coming soon)</p>
            
            <p><strong>Windows Server</strong><br>
            Easiest to use if you know the interface but much heavier to run. <em>Not recommended for long-term server use.</em></p>
            
            <h2>Server Setup & Configuration</h2>
            
            <blockquote>
                <h4>Prerequisites</h4>
                <ul>
                    <li>A Debian-based (Debian 12 bookworm) server with SSH access</li>
                    <li>Root access (All these commands are executed as root user: <code>su -l</code>)</li>
                    <li>At least 2GB of memory (each Puck server uses ~300MB)</li>
                    <li>Basic command line knowledge</li>
                </ul>
            </blockquote>
            
            <h3>Step 1: Update Your System</h3>
            <pre><code class="language-bash">apt update && apt upgrade -y</code></pre>
            
            <h3>Step 2: Install Prerequisites & SteamCMD</h3>
            <p>Install necessary tools and prepare SteamCMD:</p>
            <pre><code class="language-bash">apt install software-properties-common
echo "deb http://deb.debian.org/debian bookworm main contrib non-free" > /etc/apt/sources.list.d/nonfree.list
dpkg --add-architecture i386
apt update
apt install steamcmd</code></pre>
            
            <h3>Step 3: Create Server Download Directory</h3>
            <pre><code class="language-bash">mkdir -p /srv/puck-download</code></pre>
            
            <h3>Step 4: Download Puck Server Files</h3>
            <p>Use SteamCMD to download the server files:</p>
            <pre><code class="language-bash">steamcmd +force_install_dir /srv/puck-download +login anonymous +app_update 3481440 +quit</code></pre>
            <p><strong>Note:</strong> 3481440 is the Steam App ID for Puck's dedicated server. You can verify it on <a href="https://steamdb.info/app/3481440/">SteamDB</a>.</p>
            
            <h3>Step 5: Create System User for Running Server</h3>
            <p>Create a dedicated system user for running the server:</p>
            <pre><code class="language-bash">adduser --system --no-create-home --group puckd</code></pre>
            
            <h3>Step 6: Set Up the First Server Instance</h3>
            <p>Create the server directory and assign permissions:</p>
            <pre><code class="language-bash">mkdir -p /srv/puck/server1
cp -r /srv/puck-download/* /srv/puck/server1/
chown -R puckd:puckd /srv/puck/server1
chmod +x /srv/puck/server1/Puck.x86_64</code></pre>
            
            <h3>Step 7: Create Server Configuration</h3>
            <pre><code class="language-bash">nano /srv/puck/server1/config.json</code></pre>
            <p>Paste and modify as needed:</p>
            <pre><code class="language-json">{
  "port": 7777,
  "pingPort": 7778,
  "name": "My Dedicated Puck Server",
  "maxPlayers": 10,
  "password": "",
  "voip": false,
  "isPublic": true,
  "adminSteamIds": [],
  "reloadBannedSteamIds": false,
  "usePuckBannedSteamIds": true,
  "printMetrics": true,
  "kickTimeout": 300,
  "sleepTimeout": 60,
  "joinMidMatchDelay": 10,
  "targetFrameRate": 120,
  "serverTickRate": 100,
  "clientTickRate": 200,
  "startPaused": false,
  "allowVoting": true,
  "phaseDurationMap": {
    "Warmup": 600,
    "FaceOff": 3,
    "Playing": 300,
    "BlueScore": 5,
    "RedScore": 5,
    "Replay": 10,
    "PeriodOver": 15,
    "GameOver": 15
  }
}</code></pre>
<div class="notice-blue">
  <h4>Important Settings</h4>
  <ul>
    <li>
      <strong>Name:</strong> Enter your server name (appears in server browser)
      <ul>
        <li><em>You can use <a href="https://docs.unity3d.com/Packages/com.unity.ugui@1.0/manual/StyledText.html">Unity Rich Text</a> for colors and sizes. Be careful of the character limit and do not abuse this feature.</em></li>
      </ul>
    </li>
    <li>
      <strong>Port:</strong> Set the port number (default is 7777)
      <ul>
        <li>This is the port you will either <a href="#portforwardGuide">forward</a> (in your modem/router panel) or you can enable <a href="#upnpGuide">UPnP</a>.</li>
      </ul>
    </li>
    <li>
      <strong>targetFrameRate:</strong> The actual FPS the server will attempt to run at. Recommended to set this value 10-20 above tickRate.
    </li>
    <li>
      <strong>serverTickRate:</strong> This is essentially the "data rate" of the server. Recommended values are 240-360Hz+ if your hardware & network can handle it.
    </li>
    <li>
      <strong>clientTickRate:</strong> The rate at which players send input updates to the server (should improve input lag). You can experiment with this value - I set mine to the same as the serverTickRate.
    </li>
  </ul>
</div>
            
            <h3>Step 8: Create systemd Unit</h3>
            <pre><code class="language-bash">nano /etc/systemd/system/puck@.service</code></pre>
            <p>Paste:</p>
            <pre><code class="language-ini">[Unit]
Description=Puck Dedicated Server - %i
After=network.target

[Service]
WorkingDirectory=/srv/puck/%i
User=puckd
ExecStart=/srv/puck/%i/Puck.x86_64 --serverConfigurationPath /srv/puck/%i/config.json
Restart=on-failure

[Install]
WantedBy=multi-user.target</code></pre>
            
            <h3>Step 9: Enable and Start the Server</h3>
            <pre><code class="language-bash">systemctl daemon-reload
systemctl enable puck@server1
systemctl start puck@server1</code></pre>
            <p>Check status:</p>
            <pre><code class="language-bash">systemctl status puck@server1
journalctl -u puck@server1 -f</code></pre>
            
            <h3>Step 10: Open Firewall Ports</h3>
            <p>By default, Debian has no firewall configured, meaning all ports are open. On a VPS, this is a security risk.</p>
            
            <blockquote>
                <strong>Install <code>ufw</code> and open required UDP ports</strong>
            </blockquote>
            <pre><code class="language-bash">apt install ufw
ufw enable
ufw allow 7777/udp
ufw allow 7778/udp</code></pre>
            <p>Adjust port numbers based on your configuration.</p>
            
            <h2>Managing Multiple Servers</h2>
            <p>To run a second server:</p>
            <blockquote>
                <strong>Change ports to one above both, example 7779 & 7780</strong>
            </blockquote>
            <pre><code class="language-bash">cp -r /srv/puck/server1 /srv/puck/server2
nano /srv/puck/server2/config.json
systemctl enable puck@server2
systemctl start puck@server2</code></pre>
            
            <h2>Server Management Commands</h2>
            <ul>
                <li>View logs: <code>journalctl -u puck@server1 -f</code></li>
                <li>Restart: <code>systemctl restart puck@server1</code></li>
                <li>Stop: <code>systemctl stop puck@server1</code></li>
                <li>Update: Stop server, re-run SteamCMD in <code>/srv/puck-download</code>, copy over updated files.</li>
            </ul>
            
            <h2>Troubleshooting</h2>
            <p><strong>Service won't start</strong><br>
            Check logs with <code>journalctl -u puck@server1</code></p>
            
            <p><strong>Can't connect</strong><br>
            Double-check firewall and public IP on VPS</p>

            <p>Your Puck server should now be live and ready for players.</p>
        </section>
    </main>

    <footer>
        <p>Quickly put together by Codion</p>
        <small>© 2025</small>
    </footer>
</body>
</html>